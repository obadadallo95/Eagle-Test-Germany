# ðŸ”„ Ù…ÙŠØ²Ø© Progress Ø§Ù„Ù…Ø´ØªØ±Ùƒ Ø¨ÙŠÙ† Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© (Pro Feature)

## Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©

ØªÙ… Ø¥Ø¶Ø§ÙØ© Ù…ÙŠØ²Ø© Ø¬Ø¯ÙŠØ¯Ø© Ù„Ù„Ø§Ø´ØªØ±Ø§Ùƒ Pro: **Progress Ù…Ø´ØªØ±Ùƒ Ø¨ÙŠÙ† 3 Ø£Ø¬Ù‡Ø²Ø© ÙƒØ­Ø¯ Ø£Ù‚ØµÙ‰**

### Ø§Ù„Ù…ÙŠØ²Ø©:
- âœ… Progress Ù…Ø´ØªØ±Ùƒ Ø¨ÙŠÙ† 3 Ø£Ø¬Ù‡Ø²Ø© Pro
- âœ… Sync ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
- âœ… Ø§Ø³ØªØ¹Ø§Ø¯Ø© Progress Ø¹Ù†Ø¯ ÙÙ‚Ø¯Ø§Ù† Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„
- âœ… Ø­Ø¯ Ø£Ù‚ØµÙ‰ 3 Ø£Ø¬Ù‡Ø²Ø© (Ø§Ù„Ø£Ù‚Ø¯Ù… ÙŠØªØ­ÙˆÙ„ Ù„Ù€ Free ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹)

---

## ÙƒÙŠÙ ÙŠØ¹Ù…Ù„ Ø§Ù„Ù†Ø¸Ø§Ù…

### 1. Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Pro

```
1. Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙŠØ´ØªØ±ÙŠ Ø§Ø´ØªØ±Ø§Ùƒ Pro
   â†“
2. Progress Ù…Ø±Ø¨ÙˆØ· Ø¨Ù€ revenuecat_customer_id (Ù…Ø´ØªØ±Ùƒ)
   â†“
3. Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø¹Ù„Ù‰ Ø£ÙŠ Ø¬Ù‡Ø§Ø²:
   - ÙŠØªÙ… Ø¯Ù…Ø¬ Progress (Ø£ÙØ¶Ù„ Ù‚ÙŠÙ… Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø©)
   - ÙŠØªÙ… ØªØ­Ø¯ÙŠØ« Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
   â†“
4. Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚:
   - ÙŠØªÙ… Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø¢Ø®Ø± Progress Ù…Ù† Cloud
   - ÙŠØªÙ… Sync Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ©
```

### 2. Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Free

```
1. Progress Ù…Ø±Ø¨ÙˆØ· Ø¨Ù€ user_id (Ù…Ø®ØµØµ Ù„ÙƒÙ„ Ø¬Ù‡Ø§Ø²)
   â†“
2. Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ø¯ÙŠØ«:
   - ÙŠØªÙ… Ø­ÙØ¸ Progress Ù…Ø­Ù„ÙŠØ§Ù‹ ÙÙ‚Ø·
   - ÙŠØªÙ… Sync Ø¥Ù„Ù‰ Cloud (Ù„ÙƒÙ† ØºÙŠØ± Ù…Ø´ØªØ±Ùƒ)
```

---

## Ø§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„ØªÙ‚Ù†ÙŠØ©

### 1. Ø¬Ø¯ÙˆÙ„ `user_progress`

```sql
user_progress:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ user_id  â”‚ revenuecat_customer_idâ”‚ questions_learnedâ”‚ exams_passed â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ user-001 â”‚ rc-customer-123       â”‚ 150              â”‚ 5            â”‚ â† Pro (Ù…Ø´ØªØ±Ùƒ)
â”‚ user-002 â”‚ rc-customer-123       â”‚ 200              â”‚ 7            â”‚ â† Pro (Ù…Ø´ØªØ±Ùƒ)
â”‚ user-003 â”‚ rc-customer-123       â”‚ 180              â”‚ 6            â”‚ â† Pro (Ù…Ø´ØªØ±Ùƒ)
â”‚ user-004 â”‚ NULL                  â”‚ 50               â”‚ 1            â”‚ â† Free (Ù…Ø®ØµØµ)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. Ù†Ø¸Ø§Ù… ØªØªØ¨Ø¹ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø©

```
Ø¹Ù†Ø¯ Ø§Ù„Ø§Ø³ØªØ±Ø¯Ø§Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ù‡Ø§Ø² Ø§Ù„Ø±Ø§Ø¨Ø¹:
1. Ø§Ù„Ù†Ø¸Ø§Ù… ÙŠØªØ­Ù‚Ù‚ Ù…Ù† Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ù†Ø´Ø·Ø© (Pro)
2. Ø¥Ø°Ø§ ÙƒØ§Ù† >= 3:
   - ÙŠØ­ÙˆÙ„ Ø§Ù„Ø£Ù‚Ø¯Ù… Ù„Ù€ Free
   - ÙŠØ³Ø¬Ù„ Ø§Ù„Ø¬Ù‡Ø§Ø² Ø§Ù„Ø¬Ø¯ÙŠØ¯ ÙƒÙ€ Pro
3. Ø¥Ø°Ø§ ÙƒØ§Ù† < 3:
   - ÙŠØ³Ø¬Ù„ Ø§Ù„Ø¬Ù‡Ø§Ø² Ø§Ù„Ø¬Ø¯ÙŠØ¯ ÙƒÙ€ Pro
```

---

## Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª ÙÙŠ Ø§Ù„ÙƒÙˆØ¯

### 1. `SyncService.syncProgressToCloud()`

**Ù‚Ø¨Ù„:**
- Progress Ù…Ø±Ø¨ÙˆØ· Ø¨Ù€ `user_id` ÙÙ‚Ø·
- ÙƒÙ„ Ø¬Ù‡Ø§Ø² Ù„Ù‡ Progress Ù…Ù†ÙØµÙ„

**Ø¨Ø¹Ø¯:**
- Pro users: Progress Ù…Ø±Ø¨ÙˆØ· Ø¨Ù€ `revenuecat_customer_id` (Ù…Ø´ØªØ±Ùƒ)
- Free users: Progress Ù…Ø±Ø¨ÙˆØ· Ø¨Ù€ `user_id` (Ù…Ø®ØµØµ)
- Ø¯Ù…Ø¬ Progress Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© (Ø£ÙØ¶Ù„ Ù‚ÙŠÙ…)

### 2. `SyncService.restoreProgressFromCloud()`

**Ø¬Ø¯ÙŠØ¯:**
- Pro users: ÙŠØ³ØªØ¹ÙŠØ¯ Progress Ù…Ù† `revenuecat_customer_id`
- Free users: ÙŠØ³ØªØ¹ÙŠØ¯ Progress Ù…Ù† `user_id`

### 3. `SubscriptionService._trackDeviceAndEnforceLimit()`

**Ø¬Ø¯ÙŠØ¯:**
- ØªØªØ¨Ø¹ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ù†Ø´Ø·Ø©
- ØªØ·Ø¨ÙŠÙ‚ Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ 3 Ø£Ø¬Ù‡Ø²Ø©
- ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø£Ù‚Ø¯Ù… Ù„Ù€ Free ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹

### 4. `main.dart` - Sync ØªÙ„Ù‚Ø§Ø¦ÙŠ

**Ø¬Ø¯ÙŠØ¯:**
- `_syncAndRestoreProgressOnStartup()`
- ÙŠØ³ØªØ¹ÙŠØ¯ Progress Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
- ÙŠØ²Ø§Ù…Ù† Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ©

---

## Migration SQL

### Ø¥Ø¶Ø§ÙØ© `revenuecat_customer_id` Ø¥Ù„Ù‰ `user_progress`

```sql
-- Ù…Ù„Ù: supabase_migrations/add_revenuecat_to_user_progress.sql
-- ÙŠØ¬Ø¨ ØªØ·Ø¨ÙŠÙ‚Ù‡ ÙÙŠ Supabase Dashboard â†’ SQL Editor
```

**Ø®Ø·ÙˆØ§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚:**
1. Ø§ÙØªØ­ Supabase Dashboard â†’ `SQL Editor`
2. Ø§Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯ Ù…Ù† `supabase_migrations/add_revenuecat_to_user_progress.sql`
3. Ø§Ù„ØµÙ‚Ù‡ ÙÙŠ SQL Editor
4. Ø§Ø¶ØºØ· `Run`

---

## Ø§Ù„Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆÙ‡Ø§Øª

### âœ… Ø§Ù„Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ 1: Ù…Ø³ØªØ®Ø¯Ù… Pro Ø¹Ù„Ù‰ 3 Ø£Ø¬Ù‡Ø²Ø©

```
1. Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙŠØ´ØªØ±ÙŠ Ø§Ø´ØªØ±Ø§Ùƒ Pro
2. ÙŠØ³ØªØ®Ø¯Ù…Ù‡ Ø¹Ù„Ù‰ 3 Ù…ÙˆØ¨Ø§ÙŠÙ„Ø§Øª
3. Progress Ù…Ø´ØªØ±Ùƒ Ø¨ÙŠÙ†Ù‡Ù…:
   - Ù†ÙØ³ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ù…ØªØ¹Ù„Ù…Ø©
   - Ù†ÙØ³ Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†Ø§Øª
   - Ù†ÙØ³ Ø§Ù„ØªÙ‚Ø¯Ù…
4. Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø¹Ù„Ù‰ Ø£ÙŠ Ø¬Ù‡Ø§Ø² â†’ ÙŠØªÙ… Sync ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
```

### âœ… Ø§Ù„Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ 2: Ø§Ù„Ø¬Ù‡Ø§Ø² Ø§Ù„Ø±Ø§Ø¨Ø¹

```
1. Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙŠØ­Ø§ÙˆÙ„ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø¹Ù„Ù‰ Ù…ÙˆØ¨Ø§ÙŠÙ„ Ø±Ø§Ø¨Ø¹
2. Ø§Ù„Ù†Ø¸Ø§Ù… ÙŠØªØ­Ù‚Ù‚:
   - Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ù†Ø´Ø·Ø©: 3
   - Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ ÙˆØµÙ„
3. Ø§Ù„Ù†Ø¸Ø§Ù… ÙŠØ­ÙˆÙ„ Ø§Ù„Ø£Ù‚Ø¯Ù… Ù„Ù€ Free ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
4. Ø§Ù„Ø¬Ù‡Ø§Ø² Ø§Ù„Ø¬Ø¯ÙŠØ¯ ÙŠØµØ¨Ø­ Pro
```

### âœ… Ø§Ù„Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ 3: ÙÙ‚Ø¯Ø§Ù† Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„

```
1. Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙŠÙÙ‚Ø¯ Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ Ø§Ù„Ø£ÙˆÙ„
2. Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙŠØ´ØªØ±ÙŠ Ù…ÙˆØ¨Ø§ÙŠÙ„ Ø¬Ø¯ÙŠØ¯
3. Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙŠØ³ØªØ±Ø¯ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ
4. Ø§Ù„Ù†Ø¸Ø§Ù… ÙŠØ³ØªØ¹ÙŠØ¯ Progress Ù…Ù† Ø¢Ø®Ø± Ø¬Ù‡Ø§Ø² Ù†Ø´Ø· âœ…
5. Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙŠØ³ØªÙ…Ø± Ù…Ù† Ø­ÙŠØ« ØªÙˆÙ‚Ù
```

---

## Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø­Ø¯Ø«Ø©

1. âœ… `supabase_migrations/add_revenuecat_to_user_progress.sql` - Migration Ø¬Ø¯ÙŠØ¯
2. âœ… `lib/core/services/sync_service.dart` - Progress Ù…Ø´ØªØ±Ùƒ + Ø§Ø³ØªØ¹Ø§Ø¯Ø©
3. âœ… `lib/core/services/subscription_service.dart` - ØªØªØ¨Ø¹ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø©
4. âœ… `lib/main.dart` - Sync ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚

---

## Ø®Ø·ÙˆØ§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚

### 1. ØªØ·Ø¨ÙŠÙ‚ Migration

```sql
-- ÙÙŠ Supabase Dashboard â†’ SQL Editor
-- Ø§Ù†Ø³Ø® ÙˆØ§Ù„ØµÙ‚: supabase_migrations/add_revenuecat_to_user_progress.sql
```

### 2. Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…ÙŠØ²Ø©

1. **Ø§Ø´ØªØ±Ø§Ùƒ Pro:**
   - Ø§Ø´ØªØ±Ù Ø§Ø´ØªØ±Ø§Ùƒ Pro
   - Ø§Ø³ØªØ®Ø¯Ù…Ù‡ Ø¹Ù„Ù‰ Ù…ÙˆØ¨Ø§ÙŠÙ„ÙŠÙ†
   - ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Progress Ù…Ø´ØªØ±Ùƒ

2. **Ø§Ù„Ø¬Ù‡Ø§Ø² Ø§Ù„Ø«Ø§Ù„Ø«:**
   - Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø¹Ù„Ù‰ Ù…ÙˆØ¨Ø§ÙŠÙ„ Ø«Ø§Ù„Ø«
   - ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Progress Ù…Ø´ØªØ±Ùƒ

3. **Ø§Ù„Ø¬Ù‡Ø§Ø² Ø§Ù„Ø±Ø§Ø¨Ø¹:**
   - Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø¹Ù„Ù‰ Ù…ÙˆØ¨Ø§ÙŠÙ„ Ø±Ø§Ø¨Ø¹
   - ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„Ø£Ù‚Ø¯Ù… ØªØ­ÙˆÙ„ Ù„Ù€ Free

---

## Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ù…Ù‡Ù…Ø©

### âš ï¸ Progress Merge Logic

**Ø§Ù„Ù…Ù†Ø·Ù‚ Ø§Ù„Ø­Ø§Ù„ÙŠ:**
- ÙŠØªÙ… Ø¯Ù…Ø¬ Progress Ø¨Ø£Ø®Ø° **Ø£ÙØ¶Ù„ Ø§Ù„Ù‚ÙŠÙ…** Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø©
- `questions_learned`: Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø£ÙƒØ¨Ø±
- `exams_passed`: Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø£ÙƒØ¨Ø±
- `readiness_score`: Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø£ÙƒØ¨Ø±

**Ù…Ø«Ø§Ù„:**
```
Ø§Ù„Ø¬Ù‡Ø§Ø² 1: questions_learned = 150
Ø§Ù„Ø¬Ù‡Ø§Ø² 2: questions_learned = 200
Ø§Ù„Ø¬Ù‡Ø§Ø² 3: questions_learned = 180

Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù…Ø´ØªØ±ÙƒØ©: questions_learned = 200 (Ø§Ù„Ø£ÙØ¶Ù„)
```

### âš ï¸ Sync Frequency

**Ø­Ø§Ù„ÙŠØ§Ù‹:**
- Sync Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
- Sync Ø¹Ù†Ø¯ Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ (ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØªÙ‡)
- Sync Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª Ø§Ù„Ù…Ù‡Ù…Ø©

**Ù…Ø³ØªÙ‚Ø¨Ù„Ø§Ù‹:**
- Sync ÙÙŠ Ø§Ù„Ø®Ù„ÙÙŠØ© ÙƒÙ„ X Ø¯Ù‚Ø§Ø¦Ù‚
- Sync Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ±Ø§Øª Progress

---

## Ø§Ù„Ø®Ù„Ø§ØµØ©

âœ… **Progress Ù…Ø´ØªØ±Ùƒ Ø¨ÙŠÙ† 3 Ø£Ø¬Ù‡Ø²Ø© Pro**  
âœ… **Sync ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚**  
âœ… **Ø§Ø³ØªØ¹Ø§Ø¯Ø© Progress Ø¹Ù†Ø¯ ÙÙ‚Ø¯Ø§Ù† Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„**  
âœ… **Ø­Ø¯ Ø£Ù‚ØµÙ‰ 3 Ø£Ø¬Ù‡Ø²Ø© (Ø§Ù„Ø£Ù‚Ø¯Ù… ÙŠØªØ­ÙˆÙ„ Ù„Ù€ Free)**

**ØªØ§Ø±ÙŠØ®:** $(date)  
**Ø§Ù„Ø­Ø§Ù„Ø©:** âœ… Ø¬Ø§Ù‡Ø² Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… (Ø¨Ø¹Ø¯ ØªØ·Ø¨ÙŠÙ‚ Migration)

